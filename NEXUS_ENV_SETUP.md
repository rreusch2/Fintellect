# Enhanced Nexus Environment Setup

This guide will help you configure all the API keys and environment variables needed for the enhanced Nexus financial AI system using a dual .env structure for better security.

## Environment Structure

Following Suna's best practices, we use separate environment files:
- `server/.env` - Backend configuration (sensitive API keys)
- `client/.env.local` - Frontend configuration (public variables only)

## Backend Configuration (`server/.env`)

Create a `server/.env` file with the following variables:

```bash
# Generated by Enhanced Nexus setup script

# Environment Mode
ENV_MODE=development

# Database Configuration
DATABASE_URL="postgresql://username:password@localhost:5432/fintellect"

# Session & JWT Configuration
SESSION_SECRET="your-session-secret-here"
JWT_SECRET="your-jwt-secret-here"
JWT_REFRESH_SECRET="your-jwt-refresh-secret-here"

# Plaid Configuration (Already configured)
PLAID_CLIENT_ID="your-plaid-client-id"
PLAID_SECRET="your-plaid-secret"
PLAID_ENV="sandbox"

# LLM Providers (Enhanced Nexus)
# ================================
GOOGLE_AI_API_KEY="your-google-ai-api-key"          # REQUIRED
ANTHROPIC_API_KEY="your-anthropic-api-key"          # RECOMMENDED
OPENAI_API_KEY="your-openai-api-key"                # RECOMMENDED

# Web Research Tools
# ==================
TAVILY_API_KEY="your-tavily-api-key"                # For web search
FIRECRAWL_API_KEY="your-firecrawl-api-key"          # For web scraping
RAPIDAPI_KEY="your-rapidapi-key"                    # Additional APIs

# Secure Execution Environment
# ============================
DAYTONA_API_KEY="your-daytona-api-key"              # Optional
DAYTONA_BASE_URL="http://localhost:3986"

# Server Configuration
# ===================
PORT=5001
NODE_ENV=development
ALLOWED_ORIGINS="http://localhost:5173,http://localhost:5174"

# Redis (Optional - for caching)
# ==============================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_SSL=false
```

## Frontend Configuration (`client/.env.local`)

Create a `client/.env.local` file with only public variables:

```bash
# Frontend Environment Variables
# These are safe to expose to the client

# Environment Mode
VITE_ENV_MODE=development

# Backend API Configuration
VITE_API_BASE_URL=http://localhost:5001
VITE_NEXUS_API_URL=http://localhost:5001/api/nexus

# Public Configuration
VITE_APP_NAME=Fintellect
VITE_APP_VERSION=1.0.0

# Public Feature Flags
VITE_ENABLE_NEXUS=true
VITE_ENABLE_AI_FEATURES=true

# Public Analytics (if needed)
VITE_GOOGLE_ANALYTICS_ID=
VITE_SENTRY_DSN=
```

## API Key Setup Instructions

### 1. Google AI (Gemini) - REQUIRED ‚úÖ
- Go to [Google AI Studio](https://aistudio.google.com/)
- Create a new API key
- Add to `GOOGLE_AI_API_KEY` in `server/.env`

### 2. OpenAI - RECOMMENDED üî•
- Go to [OpenAI Platform](https://platform.openai.com/api-keys)
- Create a new API key
- Add to `OPENAI_API_KEY` in `server/.env`

### 3. Anthropic (Claude) - RECOMMENDED üî•
- Go to [Anthropic Console](https://console.anthropic.com/)
- Create a new API key
- Add to `ANTHROPIC_API_KEY` in `server/.env`

### 4. Tavily Search - FOR WEB SEARCH üåê
- Go to [Tavily](https://tavily.com/)
- Sign up and get API key
- Add to `TAVILY_API_KEY` in `server/.env`

### 5. Firecrawl - FOR WEB SCRAPING üï∑Ô∏è
- Go to [Firecrawl](https://firecrawl.dev/)
- Sign up and get API key
- Add to `FIRECRAWL_API_KEY` in `server/.env`

### 6. RapidAPI - FOR ADDITIONAL SERVICES üöÄ
- Go to [RapidAPI](https://rapidapi.com/)
- Sign up and get API key
- Add to `RAPIDAPI_KEY` in `server/.env`

### 7. Daytona - FOR SECURE EXECUTION (Optional) üê≥
- Install Daytona locally or use cloud instance
- Get API key from your Daytona instance
- Add to `DAYTONA_API_KEY` and `DAYTONA_BASE_URL` in `server/.env`

## Configuration Updates Needed

### Update Server Configuration
The server configuration in `server/config/apis.ts` should read from the server's environment:

```typescript
// These will now read from server/.env
export const apiConfig: APIConfig = {
  google: {
    apiKey: process.env.GOOGLE_AI_API_KEY || '',
    // ... rest of config
  },
  // ... other providers
};
```

### Update Client Configuration
Create a new `client/src/config/api.ts` for frontend API configuration:

```typescript
// These will read from client/.env.local
export const clientConfig = {
  apiBaseUrl: import.meta.env.VITE_API_BASE_URL || 'http://localhost:5001',
  nexusApiUrl: import.meta.env.VITE_NEXUS_API_URL || 'http://localhost:5001/api/nexus',
  enableNexus: import.meta.env.VITE_ENABLE_NEXUS === 'true',
  enableAI: import.meta.env.VITE_ENABLE_AI_FEATURES === 'true'
};
```

## Security Benefits

This dual .env structure provides:

1. **Separation of Concerns**: Frontend only gets public variables
2. **Security**: Sensitive API keys never exposed to client
3. **Deployment**: Easier to manage different environments
4. **Best Practices**: Follows industry standards like Suna

## Migration from Single .env

If you have an existing `.env` file in the project root:

1. Move all sensitive API keys to `server/.env`
2. Move public configuration to `client/.env.local`
3. Update import statements in your code
4. Test both server and client startup

## Testing Your Setup

After configuring both environment files:

1. Start the server: `cd server && npm run dev`
2. Start the client: `cd client && npm run dev`
3. Go to the Nexus interface: `http://localhost:5174/nexus`
4. Test with prompts like:
   - "Analyze my spending patterns for the last month"
   - "Research the current state of the AI market"
   - "Search for recent news about cryptocurrency"

## Troubleshooting

- **Server won't start**: Check `server/.env` for missing required keys
- **Client can't connect**: Verify `VITE_API_BASE_URL` in `client/.env.local`
- **API errors**: Ensure all API keys are valid and have proper permissions
- **CORS issues**: Check `ALLOWED_ORIGINS` in server configuration

## Cost Considerations

- **Google AI**: Very cost-effective, good free tier
- **OpenAI**: Higher cost but excellent quality
- **Anthropic**: Premium pricing for advanced capabilities
- **Tavily**: Reasonable search API pricing
- **Firecrawl**: Pay-per-scrape model

Start with Google AI + Tavily for basic functionality, then add other services as needed. 